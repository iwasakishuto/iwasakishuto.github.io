<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Shuto" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="3S, ゲノム配列解析論Ⅱ, ゲノム配列解析論Ⅱ, " />
<meta property="og:image" content="https://iwasakishuto.github.io/lecture/notes/theme/img/default_image.png"/>

<meta property="og:title" content="ゲノム配列解析論Ⅱ 第4回 "/>
<meta property="og:url" content="https://iwasakishuto.github.io/study/notes/ゲノム配列解析論Ⅱ-4.html" />
<meta property="og:description" content="RNA seq" />
<meta property="og:site_name" content="My Notes" />
<meta property="og:article:author" content="Shuto" />
<meta property="og:article:published_time" content="2019-07-01T00:00:00+09:00" />
<meta property="og:article:modified_time" content="2019-07-01T00:00:00+09:00" />
<meta name="twitter:title" content="ゲノム配列解析論Ⅱ 第4回 ">
<meta name="twitter:description" content="RNA seq">

        <title>ゲノム配列解析論Ⅱ 第4回  · My Notes
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/admonition.css" media="screen">



        <!-- Use fontawesome Icon -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
        <!-- Syntax highlight -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- LaTex -->
        <!-- Github env -->
        <!--<script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
        <script type="text/x-mathjax-config">
        	MathJax.Hub.Config({
        		tex2jax: {
        			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        			displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        		}
        	});
        </script>
        <!-- Mermaid -->
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" charset="UTF-8"></script>
        <script>
          mermaid.initialize({
            startOnLoad:true
          });
        </script>
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="https://iwasakishuto.github.io/study/notes"><span class=site-name style="color: #80273F;"><i class="fa fa-book"></i> My Notes</span></a>
                    <!--
                    <a class="brand" href="https://iwasakishuto.github.io/study/notes/"><span class=site-name style="margin-left:auto; margin-right:auto;"><i class="fas fa-book-reader"></i>My Notes</span></a>
                    -->
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="https://iwasakishuto.github.io/"><i class="fas fa-home"></i>Portfolio Top</a></li>
                            <li ><a href="https://iwasakishuto.github.io/study/notes/categories"><i class="fa fa-list-alt"></i> Categories</a></li>
                            <li ><a href="https://iwasakishuto.github.io/study/notes/tags"><i class="fa fa-tags"></i> Tags</a></li>
                            <li ><a href="https://iwasakishuto.github.io/study/notes/archives"><i class="fa fa-folder-open"></i> Archives</a></li>
                            <li><form class="navbar-search" action="https://iwasakishuto.github.io/study/notes/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://iwasakishuto.github.io/study/notes/ゲノム配列解析論Ⅱ-4.html"> ゲノム配列解析論Ⅱ 第4回  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <h1>第4回 2019/7/1</h1>
<ul>
<li>講師：<a href="https://www.u-tokyo.ac.jp/focus/ja/people/k0001_01815.html">岩切 淳一</a></li>
</ul>
<h2>Today's plan</h2>
<ul>
<li>Brief introduction of RNA<ul>
<li>central dogma</li>
<li>RNA classification (coding/non-coding)</li>
</ul>
</li>
<li>Basic ideas for estimation of transcript abundance from RNA-seq data<ul>
<li>Calculation of relative abundance (RPKM, TPM)</li>
<li>Handling multi-mapped reads</li>
</ul>
</li>
<li>Advanced RNA-seq in recent research<ul>
<li>RNA secondary structure (DMS-MaPseq)</li>
<li>RNA-protein interaction (PAR-CLIP)</li>
<li>Expression dynamics (TimeLapse-seq)</li>
</ul>
</li>
</ul>
<h2>Brief introduction of RNA</h2>
<h3>DNA・RNA・タンパク質の関係</h3>
<h4>DNA</h4>
<ul>
<li>DeoxyRiboNucleic Acid（デオキシリボ核酸）の略<ul>
<li>4種類の塩基が存在（A、C、G、T）</li>
<li>A-T（H-bond2本）、C-G（H-bond3本）は塩基対を形成</li>
<li>塩基対により2本鎖、2重らせん構造を形成</li>
</ul>
</li>
<li>ゲノム<ul>
<li>ACGTが数百万～数十億個つながった遺伝情報全体</li>
<li>ヒトでは22本の常染色体、2本の性染色体</li>
</ul>
</li>
<li>遺伝子<ul>
<li>ゲノムの中でタンパク質に関する情報が記述された（コード）領域（古）</li>
<li>タンパク質やRNA等の機能を持つ分子に関する情報がコードされた領域（新）</li>
<li>ヒトのタンパク質コード遺伝子はゲノム全体（30億塩基）の数％</li>
</ul>
</li>
</ul>
<h4>RNA</h4>
<ul>
<li>RiboNucleic Acid（リボ核酸）の略</li>
<li>DNAから転写によって合成される</li>
<li>4種類の塩基（A、G、C、U）※DNAではU→T<ul>
<li>A-U・G-U（H-bond2本）、C-G（H-bond3本）、が塩基対を形成</li>
</ul>
</li>
<li>RNAの種類<ul>
<li>messenger RNA (<font color="red">mRNA</font>)・・・<font color="red">タンパク質に翻訳される</font>中間産物</li>
<li>Non-coding RNA（<font color="red">ncRNA</font>）・・・<font color="red">タンパク質に翻訳されずに機能するRNA</font><ul>
<li>Ribosomal RNA（rRNA）・・・翻訳の中心を担う</li>
<li>transfer RNA （tRNA）・・・翻訳時にアミノ酸を運搬する</li>
<li>micro RNA（miRNA）・・・mRNAの分解（RNAi）に関わる</li>
<li>Long non-coding RNA(<font color="red">lncRNA</font>)・・・ヒト等に大量に存在、機能未知</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>Basic ideas for estimation of transcript abundance from RNA-seq data</h2>
<h3>Overview of RNA-seq workflow</h3>
<p><b>目的：遺伝子の発現量の解析</b></p>
<p>上を実現する最も簡単な手法は<b>直接RNAの発現量を見ること</b>だが、それが難しいので、RNAをcDNAに逆転写して、断片化してランダムサンプリングし、発現量を定量化する。</p>
<table>
<thead>
<tr>
<th align="center">Images</th>
<th align="center">Movie</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/97/Journal.pcbi.1004393.g002.png/1920px-Journal.pcbi.1004393.g002.png"></td>
<td align="center"><iframe src="https://www.youtube.com/embed/bAF_MFNjFpo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></td>
</tr>
</tbody>
</table>
<h3>RNA-seqデータからのリード数取得</h3>
<p>各リードがどの遺伝子・転写産物に由来しているかを調べ、遺伝子・転写産物単位でリード数を数える。
- リファレンス配列へのマッピング（今回はこれを説明）
    - 配列アラインメントを用いて、各リードがリファレンス配列中（ゲノムやトランスクリプトーム）の位置を調べ、リードを数える。
    - 利点（特にリファレンス配列にゲノム配列を用いた場合）
        - 目視によるリード（フラグメント）の確認
        - <b>未知の遺伝子への対応</b>
- k-merカウントに基づく発言量推定
    - 各リードがトランスクリプトーム中のどの転写産物に由来するかのみをBruijn Graphを用いて調べる<b>（アラインメントは行わず、位置は特定しない。）</b>
    - 利点
        - 高速・省メモリ（ノートPCで十分解析が可能なレベル）
        - マッピングベースの手法と同等の精度（既知遺伝子のみ）</p>
<h3>正規化：リード数から発現量へ</h3>
<ul>
<li><font color="red"><b>遺伝子由来のリード数 <span class="math">\(\neq\)</span> 遺伝子の発現量</b></font></li>
<li>目的に応じてリード数を正規化する必要がある。<ul>
<li>サンプル内比較（今回はこちら）
同一実験データ内で、遺伝子AとBの発現量を比較</li>
<li>サンプル間比較
複数の実験データ間で、遺伝子Aの発現量を比較</li>
</ul>
</li>
</ul>
<p>長さが長い遺伝子の方が
以下のデータが得られたとする。目的は、absolute abundance(=relative abundance)を求めること。</p>
<table>
<thead>
<tr>
<th align="center">gene <span class="math">\(i\)</span></th>
<th align="right">length[kb] <span class="math">\(l_i\)</span></th>
<th align="right">absolute abundance</th>
<th align="right">relative abundance <span class="math">\(f_i\)</span></th>
<th align="right">read count<font color="red">(observed)</font> <span class="math">\(c_i\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="right">2</td>
<td align="right">-</td>
<td align="right">-</td>
<td align="right">3</td>
</tr>
<tr>
<td align="center">2</td>
<td align="right">4</td>
<td align="right">-</td>
<td align="right">-</td>
<td align="right">2</td>
</tr>
<tr>
<td align="center">3</td>
<td align="right">4</td>
<td align="right">-</td>
<td align="right">-</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>この時、一般に以下の関係<b>（遺伝子領域の長さが長いほどリード数が多くなる）</b>が成り立つことが知られている。</p>
<div class="math">$$f_i\propto\frac{c_i}{l_i}$$</div>
<p>この関係を使った正規化の方法は、以下の二種類が存在している。</p>
<h4>RPKM(Reads Per Kilobase per Million mapped reads)</h4>
<p>総和が一定の値にならないので、最近使われてない。</p>
<blockquote>
<p>むしろ何故これが採用されていたのか疑問…。</p>
</blockquote>
<div class="math">$$R P K M_{i}=10^{6} \times \frac{c_{i}}{l_{i} N} \qquad N=\sum c_{i}$$</div>
<ul>
<li><span class="math">\(R P K M_{1}=10^{6} \times \frac{3}{2 \times 11}\)</span></li>
<li><span class="math">\(R P K M_{2}=10^{6} \times \frac{2}{4 \times 11}\)</span></li>
<li><span class="math">\(R P K M_{3}=10^{6} \times \frac{6}{4 \times 11}\)</span></li>
</ul>
<h4>TPM(Transcripts Per Million)</h4>
<p>先ほどとほとんど変わらないが、転写産物の総和を <span class="math">\(10^6\)</span> に揃えているだけ。</p>
<div class="math">$$T P M_{i}=10^{6} \times \frac{R P K M_{i}}{\sum R P K M_{j}}=10^{6} \times \frac{\frac{c_{i}}{l_{i}}}{\sum \frac{c_{j}}{l_{j}}}$$</div>
<h3>Options for handling multi-mapped reads</h3>
<p>異なる遺伝子領域に同じ配列（リピート配列）があった場合の対処方法は、いくつか考えられている。</p>
<blockquote>
<p>が、上３つは<b>かなり頭が悪い</b>。これらの手法で<b>"Handling"</b>とか言わないで欲しい。というか、一番下もそこまで賢くない。単純に<b>「リピート配列以外の発現量（×リード数）に比例してリピート配列を割り振る」</b>だけ。EMのように繰り返して収束させた方が良いと思う。</p>
</blockquote>
<ul>
<li>Ignore multi-mapped reads<ul>
<li>Estimate abundances using <b>only uniquely-mapped reads</b></li>
</ul>
</li>
<li>Count multi-mapped read as usual<ul>
<li>e.g. 1 read – 2 locations -&gt; <b>1 count for each location</b></li>
</ul>
</li>
<li>Divide a read according to the number of locations<ul>
<li>e.g. 1 read - 2 locations -&gt; <b>1/2 count for each location</b></li>
</ul>
</li>
<li>"Rescue" multi-mapped reads according to estimated abundances<ol>
<li>Estimate abundances using uniquely-mapped reads</li>
<li>Divide &amp; assign a multi-mapped read proportionally to their abundances estimated in Step1</li>
<li>Re-estimate abundances using read counts obtained in Step2</li>
</ol>
</li>
<li>etc…</li>
</ul>
<h2>Advanced RNA-seq in recent research</h2>
<ul>
<li>通常のRNA-seq: 遺伝子の発現量の解析</li>
<li>ここからのRNA-seq: 特定の領域・部分に注目</li>
</ul>
<h3>DMA-MaPseq</h3>
<p>論文: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27819661">DMS-MaPseq for genome-wide or targeted RNA structure probing in vivo.</a></p>
<p>RNA構造中で<b>塩基対を作っていない領域</b>に特定の塩基置換を導入し、「置換がどこに入っていたか」を調べることで、RNAの構造を実験的に調べる。</p>
<p>硫酸ジメチル（DMS）が<b>対を形成していないアデニンおよびシトシン残基のみと反応する</b>ことを利用。</p>
<h3>PAR-CLIP</h3>
<p>論文: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24581442">PAR-CLIP (Photoactivatable Ribonucleoside-Enhanced Crosslinking and Immunoprecipitation): a step-by-step protocol to the transcriptome-wide identification of binding sites of RNA-binding proteins.</a></p>
<p>RNA上の<b>タンパク質が結合している領域</b>に特定の塩基置換を導入する。</p>
<p>培養液中に4-チオウリジン (4sU)を添加し、これをウリジンの代わりにRNAに取り込ませませると、4sUを含むRNAが長波長紫外線照射によって、蛋白質と強力に架橋しするという性質を利用。</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/JBt8zPEhWPw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>TimeLapse-seq</h3>
<p>論文: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29355846">TimeLapse-seq: adding a temporal dimension to RNA sequencing through nucleoside recoding.</a></p>
<p>新規転写産物に4sU（特殊なU）を取り込ませると、SequenceされるときにはU(T)がCとして読まれる。</p>
<p>すると、新しく転写された転写産物に4sUを取り込ませているため、マッピングされたリードの中で<b>T→C置換のリード割合が高いものほど転写・分解が活発</b>と言える。</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        fonts: [['STIX', 'TeX']]," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            <div>
</div>

            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h5>Published</h5>
            <time itemprop="dateCreated" datetime="2019-07-01T00:00:00+09:00"> 7 1, 2019</time>

<h5>Last Updated</h5>
<time datetime="2019-07-01T00:00:00+09:00"> 7 1, 2019</time>

            <h5>Category</h5>
            <a class="category-link" href="https://iwasakishuto.github.io/study/notes/categories.html#genomupei-lie-jie-xi-lun-ii-ref">ゲノム配列解析論Ⅱ</a>
            <h5>Tags</h5>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://iwasakishuto.github.io/study/notes/tags#3s-ref">3S
                    <span>72</span>
</a></li>
                <li><a href="https://iwasakishuto.github.io/study/notes/tags#genomupei-lie-jie-xi-lun-ii-ref">ゲノム配列解析論Ⅱ
                    <span>4</span>
</a></li>
            </ul>
<h5>Contact</h5>
    <a href="https://twitter.com/cabernet_rock" title="My twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-twitter sidebar-social-links"></i></a>
    <a href="https://github.com/iwasakishuto" title="My github Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-github sidebar-social-links"></i></a>
    <a href="https://www.facebook.com/iwasakishuto" title="My facebook Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-facebook sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="https://github.com/Pelican-Elegant/elegant/" title="Theme Elegant Home Page">Elegant</a></li>
    </ul>
</div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>
        <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>

    
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/custom.css" media="screen">
    </body>
    <!-- Theme: Elegant built for Pelican
    License : MIT -->
</html>