<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Shuto" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="3S, 生物情報ソフトウエア論, 生物情報ソフトウエア論, " />
<meta property="og:image" content="https://1.bp.blogspot.com/-bU_3kgyrDp4/VkLHVEHswnI/AAAAAAAA0VI/hW-viHFn-74/s400/school_test_seifuku_boy.png"/>

<meta property="og:title" content="生物情報ソフトウエア論Ⅱ 2018年解答 "/>
<meta property="og:url" content="https://iwasakishuto.github.io/study/notes/生物情報ソフトウエア論Ⅱ-2018.html" />
<meta property="og:description" content="期末テスト" />
<meta property="og:site_name" content="My Notes" />
<meta property="og:article:author" content="Shuto" />
<meta property="og:article:published_time" content="2019-07-25T00:00:00+09:00" />
<meta property="og:article:modified_time" content="0019-07-25T00:00:00+09:19" />
<meta name="twitter:title" content="生物情報ソフトウエア論Ⅱ 2018年解答 ">
<meta name="twitter:description" content="期末テスト">

        <title>生物情報ソフトウエア論Ⅱ 2018年解答  · My Notes
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/admonition.css" media="screen">



        <!-- Use fontawesome Icon -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
        <!-- Syntax highlight -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
        <!-- Custom CSS -->
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/custom.css" media="screen">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- LaTex -->
        <!-- Github env -->
        <!--<script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
        <script type="text/x-mathjax-config">
        	MathJax.Hub.Config({
        		tex2jax: {
        			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        			displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        		}
        	});
        </script>
        <!-- Mermaid -->
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" charset="UTF-8"></script>
        <script>
          mermaid.initialize({
            startOnLoad:true
          });
        </script>
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="https://iwasakishuto.github.io/study/notes"><span class=site-name style="color: #80273F;"><i class="fa fa-book"></i> My Notes</span></a>
                    <!--
                    <a class="brand" href="https://iwasakishuto.github.io/study/notes/"><span class=site-name style="margin-left:auto; margin-right:auto;"><i class="fas fa-book-reader"></i>My Notes</span></a>
                    -->
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="https://iwasakishuto.github.io/"><i class="fas fa-home"></i>Portfolio Top</a></li>
                            <li ><a href="https://iwasakishuto.github.io/study/notes/categories"><i class="fa fa-list-alt"></i> Categories</a></li>
                            <li ><a href="https://iwasakishuto.github.io/study/notes/tags"><i class="fa fa-tags"></i> Tags</a></li>
                            <li ><a href="https://iwasakishuto.github.io/study/notes/archives"><i class="fa fa-folder-open"></i> Archives</a></li>
                            <li><form class="navbar-search" action="https://iwasakishuto.github.io/study/notes/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://iwasakishuto.github.io/study/notes/生物情報ソフトウエア論Ⅱ-2018.html"> 生物情報ソフトウエア論Ⅱ 2018年解答  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <h1>2018年 解答</h1>
<p>テスト対策と言うことで2018年の過去問（講義（Web: <a href="https://mlab.cb.k.u-tokyo.ac.jp/courseware">link</a>）に載っている）を解いたので、その解答をまとめました。</p>
<h2>問題1 Chaining</h2>
<h3>Chaining</h3>
<ul>
<li>文字列 <span class="math">\(\mathrm{Z}\)</span> の開始位置 <span class="math">\(sx\)</span> から終了位置 <span class="math">\(ex-1\)</span> までの連続した部分文字列を、<span class="math">\(\mathrm{Z}[sx,ex)\)</span> と表現する。</li>
<li>２つの文字列 <span class="math">\(\mathrm{P,Q}\)</span> のなかで、類似した部分文字列<span class="math">\(\mathrm{P}[sx,ex),\mathrm{Q}[sy,ey)\)</span>の組を、類似度を表すスコアとともに以下のように表現し、アラインメントと呼ぶ。
<div class="math">$$\mathrm{A}=\left(\mathrm{P}[sx,ex),\mathrm{Q}[sy,ey),\text{score}\right)$$</div>
と表現し、アラインメントと呼ぶ。</li>
<li>２つのアラインメント <span class="math">\(\mathrm{A,B}\)</span> 間で、以下が満たされている場合 <span class="math">\(\mathrm{A}&lt;\mathrm{B}\)</span> と定義する。<b>（半開区間で定義しているので、<span class="math">\(\mathrm{A}\)</span> と <span class="math">\(\mathrm{B}\)</span> のアラインメントを重ねることができる。）</b><ul>
<li><span class="math">\(\mathrm{A}.ex\leq \mathrm{B}.sx\)</span></li>
<li><span class="math">\(\mathrm{A}.ey\leq \mathrm{B}.sy\)</span></li>
</ul>
</li>
<li>アラインメント <span class="math">\(A_1&lt;A_2&lt;\ldots&lt;A_k\)</span> を鎖(chain)と呼ぶ。ここで、以下の二つを定義<ul>
<li>鎖の長さを <span class="math">\(k\)</span></li>
<li>鎖のスコアを <span class="math">\(\sum_i\mathrm{A}_i.\text{score}\)</span></li>
</ul>
</li>
</ul>
<h4>目的</h4>
<p>動的計画法を用いて、最大スコアの鎖を求める。</p>
<h4>アルゴリズム</h4>
<div class="highlight"><pre><span></span><span class="c1">#=== Initialization steps ===</span>
<span class="n">X</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">Alignments</span><span class="p">:</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">A</span><span class="o">.</span><span class="n">sx</span><span class="p">,</span> <span class="n">A</span><span class="p">))</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">A</span><span class="o">.</span><span class="n">ex</span><span class="p">,</span> <span class="n">A</span><span class="p">))</span>

<span class="c1"># If x1 is equal to x2, they are sorted by whether it is &quot;start point&quot; or &quot;end point&quot;.</span>
<span class="n">X</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sx</span><span class="p">))</span>

<span class="n">Y</span><span class="o">=</span><span class="p">[]</span>

<span class="c1">#=== Repeat steps ===</span>
<span class="k">while</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#=== Case1 ===</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">ex</span><span class="p">:</span>
        <span class="n">C_flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">C</span><span class="o">.</span><span class="n">ey</span><span class="o">&lt;=</span><span class="n">B</span><span class="o">.</span><span class="n">ey</span> <span class="ow">and</span> <span class="n">C</span><span class="o">.</span><span class="n">score</span><span class="o">&gt;=</span><span class="n">B</span><span class="o">.</span><span class="n">score</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">C</span> <span class="ow">in</span> <span class="n">Y</span><span class="p">]</span>
        <span class="c1"># If alignment &quot;C&quot; which is better than alignment &quot;B&quot; is not in Y.</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">C_flags</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">B</span><span class="o">.</span><span class="n">ey</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># If alignemd &quot;D&quot; is worse than alignment &quot;B&quot; remove &quot;D&quot; from Y.</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">D</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">D</span> <span class="ow">in</span> <span class="n">Y</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">ey</span><span class="o">&lt;=</span><span class="n">D</span><span class="o">.</span><span class="n">ey</span> <span class="ow">and</span> <span class="n">B</span><span class="o">.</span><span class="n">score</span><span class="o">&gt;</span><span class="n">D</span><span class="o">.</span><span class="n">score</span><span class="p">)]</span>

            <span class="c1">#=== Print the Y&#39;s transition ===</span>
            <span class="k">for</span> <span class="n">y</span><span class="p">,</span><span class="n">A</span> <span class="ow">in</span> <span class="n">Y</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{}{}{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>

    <span class="c1">#=== Case2 ===</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">sx</span><span class="p">:</span>
        <span class="c1"># This flag indicates whether there is alignment &quot;C&quot; which alignment &quot;B&quot; can connect to.</span>
        <span class="n">C_flags</span> <span class="o">=</span> <span class="p">[(</span><span class="n">C</span><span class="o">.</span><span class="n">ey</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">C</span> <span class="ow">in</span> <span class="n">Y</span> <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ex</span><span class="o">&lt;=</span><span class="n">B</span><span class="o">.</span><span class="n">sx</span> <span class="ow">and</span> <span class="n">C</span><span class="o">.</span><span class="n">ey</span><span class="o">&lt;=</span><span class="n">B</span><span class="o">.</span><span class="n">sy</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">C_flags</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span><span class="n">nearestC</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">C_flags</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">newB</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">nearestC</span><span class="o">.</span><span class="n">sx</span><span class="p">,</span> <span class="n">nearestC</span><span class="o">.</span><span class="n">sy</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">ex</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">ey</span><span class="p">,</span> <span class="n">nearestC</span><span class="o">.</span><span class="n">score</span><span class="o">+</span><span class="n">B</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
            <span class="n">X</span> <span class="o">=</span> <span class="p">[(</span><span class="n">B</span><span class="o">.</span><span class="n">ex</span><span class="p">,</span> <span class="n">newB</span><span class="p">)</span> <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="n">B</span><span class="o">.</span><span class="n">name</span> <span class="k">else</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">A</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">A</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
</pre></div>


<h3>1</h3>
<p>アラインメント <span class="math">\(\mathrm{B}1\)</span> の開始位置 <span class="math">\(\mathrm{B}1.sx\)</span> とアラインメント <span class="math">\(\mathrm{B}2\)</span> の終了位置 <span class="math">\(\mathrm{B}2.ex\)</span> が等しい時、②→①の順番だとスコアが高い終了位置のアラインメントが見落とされる可能性が出てしまう。</p>
<h4>コメント</h4>
<p>アルゴリズム（設問）の説明が悪いと感じた。
<span class="math">\(X\)</span> の先頭を取り出す際（<span class="math">\(X\)</span> をソートする際）に、同じ <span class="math">\(x\)</span> であれば開始位置（ステップ②）のものより終了位置（ステップ①）のものを先に取り出すべきであり、ここではそのことに言及していると思われる。</p>
<h3>2</h3>
<p>ステップ②で、<span class="math">\(Y\)</span> 内部から <span class="math">\(\mathrm{C}&lt;\mathrm{B}\)</span> を満たすもののうち <span class="math">\(\mathrm{B}.sy\)</span> に <span class="math">\(ey\)</span> が最も近いものを選択するため、スコアがより良く <span class="math">\(ey\)</span> の小さい（＝<span class="math">\(\mathrm{B}.sy\)</span> から遠い）<span class="math">\(\mathrm{C}\)</span> が見過ごされてしまう可能性が出てしまう。</p>
<h3>3</h3>
<p>値の検索・挿入・削除を <span class="math">\(O(\log n)\)</span> で計算する平衡木（2-3木、赤黒木）を使ってアラインメントのリスト <span class="math">\(Y\)</span> を実装すれば、最悪計算量 <span class="math">\(O(n\log n)\)</span> で最大スコアのchainが計算できる。</p>
<h2>問題2 DNA修飾情報分析</h2>
<h3>1</h3>
<p>真核生物の DNA は、核内において蛋白質複合体であるクロマチンの状態で存在する。クロマチンはヌクレオソームから構成され、4種類のヒストンタンパク質H2A,H2B,H3,H4がそれぞれ2つずつ合わさった8量体のコア・ヒストンに、DNAが巻きついた構造を取る。</p>
<p>ヒストンがメチル化やアセチル化などの化学的な修飾を受けると、クロマチンは</p>
<ul>
<li>DNAの<b>凝集密度が低く</b>転写因子が結合しやすく転写が活発に行われる<b>ユークロマチン</b></li>
<li>DNAが<b>凝集</b>して転写因子が結合しにくい<b>ヘテロクロマチン</b></li>
</ul>
<p>にその形状が変化する。</p>
<p>エンハンサーは遺伝子の転写量を増加させる作用をもつDNA領域のことで、遺伝子活性化因子と結合することで遺伝子の転写量を大幅に増大させる。</p>
<h3>2</h3>
<p>このアルゴリズムは、各記号の意味を正しく抑えることが重要である。</p>
<h4>目的</h4>
<p>実数値の列 <span class="math">\(\left\{L_i|i=1,2,\ldots,n\right\}\)</span> 上の互いに交わらない区間の集合 <span class="math">\(C = \left\{[a_1,b_1],\ldots,[a_k,b_k]\right\}\)</span> の中で、重み <span class="math">\(w(C) = \sum_{i\in I_j\in C}L_i\)</span> を最大化するものを <span class="math">\(O(n)\)</span> で計算するアルゴリズムの構築。</p>
<h4>制約条件</h4>
<p>この時、各区間の開始点 <span class="math">\(a_t\)</span> と終点 <span class="math">\(b_t\)</span> は、以下の不等式を満たす。</p>
<ol>
<li><span class="math">\(m_1\leq b_t-a_t+1\)</span>：<font color="red"><b>最終区間以外の</b></font>各区間の長さは <span class="math">\(m_1\)</span> 以上離れている。（<span class="math">\(t=1,\ldots,k-1\)</span>）</li>
<li><span class="math">\(m_0\leq a_t-b_{t-1}+1\)</span>：隣接する区間は <span class="math">\(m_0\)</span> 以上離れている。</li>
<li><span class="math">\(a_1=1\)</span> <font color="red"><b>または <span class="math">\(a_1\geq m_0+1\)</span></b></font></li>
</ol>
<p><b>※注意すべき点は、上記の<font color="red"><b>赤字部分</b></font>である。これらには生物学的な意味は<font color="red"><b>全くなく</b></font>、アルゴリズム設計を単純にするための条件である。</b></p>
<p>ここで、条件1を満たす区間集合を、<font color="red"><b>最終区間 <span class="math">\([a_k,b_k]\)</span> の状態で</b></font>以下の2通りに場合分けする。</p>
<ul>
<li><span class="math">\(C^0_{i,m}\)</span><ul>
<li><span class="math">\(b_k!=i\)</span> つまり、位置 <span class="math">\(i\)</span> で修了していない。</li>
<li><span class="math">\(i\)</span> が最終区間の終点 <span class="math">\(b_k\)</span> から <span class="math">\(m\)</span> 以上離れている。（<span class="math">\(m\leq i-b_k+1\)</span>）</li>
</ul>
</li>
<li><span class="math">\(C^1_{i,m}\)</span><ul>
<li><span class="math">\(b_k==i\)</span> つまり、位置 <span class="math">\(i\)</span> で修了している。</li>
<li>最終区間の長さが <span class="math">\(m\)</span> 以上ある。（<span class="math">\(m\leq b_k-a_k+1\)</span>）</li>
</ul>
</li>
</ul>
<p>動的計画法によってこの問題を解くために、以下の4つの変数を導入する。</p>
<table>
<thead>
<tr>
<th align="center">変数</th>
<th align="left">意味</th>
<th align="left">漸化式でのお気持ち</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><span class="math">\(W_{\text { short }}^{0}(i)=w\left(C_{i, 1}^{0}\right)\)</span></td>
<td align="left">位置 <span class="math">\(i\)</span> で終了していないが、<font color="red"><b>位置 <span class="math">\(i\)</span> から始まる次の区間 <span class="math">\([a_{k+1}=i,b_{k+1}]\)</span> を集合 <span class="math">\(C\)</span> に追加することができない。</b></font>（<span class="math">\(\because a_{k+1}-b_{k}+1\geq1\)</span> しか間隔が保証されていないから。）</td>
<td align="left">次の新しい区間を作れるよう、1つ前の区間の終点からの間隔を広げたい。</td>
</tr>
<tr>
<td align="center"><span class="math">\(W_{\text { long }}^{0}(i)=w\left(C_{i, m_0}^{0}\right)\)</span></td>
<td align="left">位置 <span class="math">\(i\)</span> で終了しておらず、<font color="red"><b>位置 <span class="math">\(i\)</span> から始まる次の区間 <span class="math">\([a_{k+1}=i,b_{k+1}]\)</span> を集合 <span class="math">\(C\)</span> に追加することができる。</b></font>（<span class="math">\(\because a_{k+1}-b_{k}+1\geq m_0\)</span> 分の間隔が保証されているから。）</td>
<td align="left"><span class="math">\(i\)</span> から開始する区間を作って集合 <span class="math">\(C\)</span> に追加したい。</td>
</tr>
<tr>
<td align="center"><span class="math">\(W_{\text { short }}^{1}(i)=w\left(C_{i, 1}^{1}\right)\)</span></td>
<td align="left">最終区間 <span class="math">\([a_{k},b_{k}=i]\)</span> が位置 <span class="math">\(i\)</span> で終了しており、集合 <span class="math">\(C\)</span> に追加することができるが、<font color="red"><b>次の区間<span class="math">\([a_{k+1}=i+m_0+1,b_{k+1}]\)</span> を集合 <span class="math">\(C\)</span> に追加することができない。</b></font>（<span class="math">\(\because b_k-a_k+1\geq 1\)</span> しか間隔が保証されていないから。）</td>
<td align="left">無理やり <span class="math">\(i\)</span> までの区間を考えた。最終区間であれば集合 <span class="math">\(C\)</span> に追加できるが、途中の区間としては区間長が足りない。</td>
</tr>
<tr>
<td align="center"><span class="math">\(W_{\text { long }}^{1}(i)=w\left(C_{i, m_1}^{1}\right)\)</span></td>
<td align="left">最終区間 <span class="math">\([a_{k},b_{k}=i]\)</span> が位置 <span class="math">\(i\)</span> で終了しており、集合 <span class="math">\(C\)</span> に追加することができる。また、<font color="red"><b>次の区間<span class="math">\([a_{k+1}=i+m_0+1,b_{k+1}]\)</span> も集合 <span class="math">\(C\)</span> に追加することができる。</b></font>（<span class="math">\(\because b_k-a_k+1\geq m_1\)</span> 分の間隔が保証されているから。）</td>
<td align="left"><span class="math">\(i\)</span> までの区間を考えたが、区間長が十分あるので、<span class="math">\(i+m_0+1\)</span> から始まる次の区間も考えたい。</td>
</tr>
</tbody>
</table>
<p>したがって、以下の漸化式を計算することで、重み <span class="math">\(w(C)\)</span> を最大化することが可能である。</p>
<h4>初期条件</h4>
<div class="math">$$W_{\text { short }}^{0}(1)=0,W_{\text { short }}^{1}(1)=L_{1}$$</div>
<h4>漸化式</h4>
<div class="math">$$\begin{aligned}
W_{\text { short }}^{0}(i)
&amp;=\max \left\{W_{\text {short}}^{0}(i-1), W_{\text {long}}^{1}(i-1)\right\}(i&gt;1)\\
W_{\text { short }}^{1}(i)
&amp;=\max \left\{W_{\text { short }}^{1}(i-1), W_{\text {long}}^{0}(i-1)\right\}+L_{i}(i&gt;1)\\
W_{\text { long }}^{0}(i)
&amp;=W^{0}_{\text { short }}\left(i-m_{0}+1\right)\left(i \geq m_{0}\right)\\
W_{\text { long }}^{1}(i)
&amp;=W^{1}_{\text { short }}\left(i-m_{1}+1\right)+w(\left\{[i-m_1+2,i]\right\})\left(i \geq m_{1}\right)
\end{aligned}$$</div>
<p>この時、<span class="math">\(w(\left\{[i-m_1+2,i]\right\})\)</span> の計算が <span class="math">\(O(1)\)</span> であるとすれば、各漸化式を計算するコストは <span class="math">\(O(1)\)</span> これを <span class="math">\(i=[1,n]\)</span> についてそれぞれ考えるから、計算量は <span class="math">\(O(n)\)</span></p>
<p><b>トレースバック</b>
<span class="math">\(\max\left\{W_{\text{long}}^1(n), W_{\text{short}}^0(n)\right\}\)</span> から始めてトレースバック。</p>
<h2>問題3 DNA3次元折りたたみ構造</h2>
<p>参考論文：<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2858594/">Comprehensive mapping of long range interactions reveals folding principles of the human genome</a></p>
<div style="border: solid 1.0px #000000;padding: 0.5em 1em; margin: 2em 0;">
<h3>Hi-C解析とは</h3>
ゲノム配列そのものからは知ることができない染色体の立体構造を、ゲノム配列のシーケンシングによって明らかにする解析のこと。<font color="red"><b>DNAの空間的な近接性は、制限酵素処理された断片間でのライゲーションの生じやすさで測れる</b></font>という考え方が基になっている。<br>
<ol>
  <li>実際に細胞の中で近接しているDNAとタンパク質の複合体をホルムアルデヒド処理することで固める。</li>
  <li>制限酵素を用いて断片化する。</li>
  <li><b>端にビオチン化ヌクレオチドを付加する。</b></li>
  <li>ライゲーション処理をする。</li>
  <li>濃縮してビオチンプルダウンする。（ビオチンの付いたもの、つまりキメラ化したものだけを選択的に抽出したいから。）</li>
  <li>ペアエンドでシーケンスする。<font color="red"><b>（∵Forward, Reverseのリードがリファレンスゲノムへマッピングされた位置を調べ、それらのゲノム状の領域がもともと空間的に近接していた、と解釈する。）</b></font></li>
</ol>
<img src="https://www.researchgate.net/publication/44590762/figure/fig1/AS:601596635381764@1520443223341/Hi-C-overview-Cells-are-cross-linked-with-formaldehyde-resulting-in-covalent-links.png">

<b>※ビオチンの付いた部分であり、ホルムアルデヒドで固められた部分そのものをシークエンスしている訳ではない。制限酵素処理された時の配列の長さにも依存してしまう。</b><br>
<b>※精度の高いリファレンスゲノムがあることが前提。</b>
</div>

<h3>1</h3>
<h4>定義</h4>
<table>
<thead>
<tr>
<th align="center">変数</th>
<th align="left">意味</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><span class="math">\(s_{ij}\)</span></td>
<td align="left">2点 <span class="math">\(i,j\)</span> 間の距離</td>
</tr>
<tr>
<td align="center"><span class="math">\(O_{ij}\)</span></td>
<td align="left">Observed, Hi-Cで観測された位置 <span class="math">\(i,j\)</span> 間の接触の数</td>
</tr>
<tr>
<td align="center"><span class="math">\(E_{ij}\)</span></td>
<td align="left">Expected, 距離 <span class="math">\(s_{ij}\)</span> の位置間で観測される接触数の平均値</td>
</tr>
<tr>
<td align="center"><span class="math">\(M^{\star}_{ij} = O_{ij}/E_{ij}\)</span></td>
<td align="left">正規化された contact matrix</td>
</tr>
<tr>
<td align="center"><span class="math">\(C_{ij}\)</span></td>
<td align="left"><b>Pearson correlation</b> between the <span class="math">\(M^{\star}_{i}\)</span> and <span class="math">\(M^{\star}_{j}\)</span></td>
</tr>
</tbody>
</table>
<p>この時、<span class="math">\(C_{ij}\)</span> は実対称行列なので、ある直交行列 <span class="math">\(P\)</span> で対角化できる。</p>
<p><b>「固有値最大の固有ベクトル <span class="math">\(P_i\)</span>」</b>、主成分分析の言葉で言い換えれば<b>「共分散行列 <span class="math">\(C_{ij}\)</span> の第一主成分ベクトル」</b>の正/負の値で分けられた2つの大域的な構造がA/B compartmentである。</p>
<h4>生物学的な意義</h4>
<p>同じコンパートメントに属している場合（AとBの場合）の方が、そうでない場合よりも、領域のスペースが近くなる傾向がある。また、上記論文（<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2858594/">link</a>）においては、コンパートメントAと遺伝子発現量や<span class="marker-info" aria-label="修飾を受けるヒストン上の位置。有名なものにH3K4me1,H3K9me3,H3K27me3などがある。">各ヒストンマーク（活性型のH3K36や抑制型のH3K27）</span>のメチル化が正の相関があることを示している。</p>
<p><b>つまり、大域的に見れば「コンパートメント単位で遺伝子やエンハンサーの相互作用が制限されている」と考えることができる。</b></p>
<h3>2</h3>
<h4>定義</h4>
<p><font color="red"><b>※ 以下の変数 <span class="math">\(A,B\)</span> は上記のABコンパートメントとは関係がない。</b></font></p>
<div class="math">$$\mathrm{DI} = \left(\frac{B-A}{|B-A|}\right)\left(\frac{(A-E)^2}{E}+\frac{(B-E)^2}{E}\right)$$</div>
<table>
<thead>
<tr>
<th align="center">変数</th>
<th align="left">意味</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><span class="math">\(A\)</span></td>
<td align="left">あるbinとその<font color="red"><b>上流</b></font> <span class="math">\(2\ \mathrm{Mb}\)</span> をリンクするリード数</td>
</tr>
<tr>
<td align="center"><span class="math">\(B\)</span></td>
<td align="left">あるbinとその<font color="red"><b>下流</b></font> <span class="math">\(2\ \mathrm{Mb}\)</span> をリンクするリード数</td>
</tr>
<tr>
<td align="center"><span class="math">\(E\)</span></td>
<td align="left"><span class="math">\((A+B)/2\)</span> つまり、帰無仮説での期待値</td>
</tr>
<tr>
<td align="center"><span class="math">\(\mathrm{DI}\)</span></td>
<td align="left">第一項は正負の符号（<span class="math">\(\mathrm{sign}(B-A)\)</span> と同値）<br>第二項はカイ二乗検定</td>
</tr>
</tbody>
</table>
<h4>生物学的な意義</h4>
<ul>
<li><b>TAD(Topologically Associated Domain)</b>は、各コンパートメントの内のさらに局所的な構造である。</li>
<li>TAD間の境界にはCTCFというタンパク質が結合していることが多い。コヒーシンがCTCF依存的に結合してインシュレーター（区切り壁）の役割を果たしていると考えられているため、TADごとにループ構造が（いくつか）あり、構造的に区切られていると考えることもできる。</li>
<li>それぞれの細胞分化に必要な遺伝子群を、分化ステージや細胞系列に合わせて狭い領域にまとめることは難しい。このため<b>全く異なる細胞で発現する遺伝子が隣接して存在することはゲノムでは普通に見られる。</b>したがって、一つのTADの発現が、隣のTADにある遺伝子の発現に影響を及ぼさないよう構造化されているのであれば、それは特に<b>初期胚での確立過程において極めて重要な役割を果たす。</b></li>
<li>各TADの間には、種間でよく保存された、CTCF分子の結合配列、house keeping遺伝子、tRNA遺伝子、そしてSINEトランスポゾンなどが集まった境界領域が存在している。</li>
</ul>
<h3>3</h3>
<p>距離行列 <span class="math">\(D\)</span> とグラム行列 <span class="math">\(G\)</span> の関係は以下で表される。なお、距離行列は実験的にはHi-Cで観測する。</p>
<div class="math">$$
\begin{aligned}
D_{i j}^{2}
&amp;=\left|\vec{V}_{i}-\vec{V}_{j}\right|^{2}\\
&amp;=\left|\vec{V}_{i}\right|^{2}+\left|\vec{V}_{j}\right|^{2}-2 \vec{V}_{i} \cdot \vec{V}_{j}\\
G_{i j}
&amp;=\vec{V}_{i} \cdot \vec{V}_{j}\\
&amp;=1/2\left(\left|\vec{V}_{i}\right|^{2}+\left|\vec{V}_{j}\right|^{2}-D_{i j}^{2}\right)
\end{aligned}
$$</div>
<p>ここで、<b>グラム行列の計算には、<span class="math">\(D\)</span> の値に加えて <span class="math">\(\left|\vec{V}_{i}\right|^{2},\left|\vec{V}_{j}\right|^{2}\)</span> の値が必要</b>となる。そこで、点全体の重心が原点となるように各 <span class="math">\(\left|\vec{V}_{i}\right|\)</span> を <span class="math">\(\left|\vec{V}_{0i}\right|\)</span> へ平行移動する。<font color="red"><b>（この時、<span class="math">\(D_{ij}\)</span> は不変）</b></font></p>
<div class="math">$$
\begin{aligned}
\overrightarrow{V_{0 i}} &amp;:=\vec{V}_{i}-\sum_{j=1}^{N} \vec{V}_{j} / N \\
\left|\overrightarrow{V_{0 i}}\right|^{2}&amp;=1 / N \sum_{j=1}^{N} D_{i j}^{2}-1 / N^{2} \sum_{j=1}^{N} \sum_{k&gt;j}^{N} D_{j k}^{2}
\end{aligned}
$$</div>
<p>すると、上記の式よりグラム行列が <span class="math">\(D\)</span> のみから計算することができる。</p>
<p>ここで、グラム行列 <span class="math">\(G\)</span> は実対称行列なので、ある直交行列 <span class="math">\(P\)</span>（各列が固有ベクトル）を用いて対角化できる。</p>
<div class="math">$$
P^{t} G P=A=\left[\begin{array}{cccc}{\lambda_{1}} &amp; {0} &amp; {\cdots} &amp; {0} \\ {0} &amp; {\lambda_{2}} &amp; {\cdots} &amp; {0} \\ {\vdots} &amp; {\vdots} &amp; {\ddots} &amp; {\vdots} \\ {0} &amp; {0} &amp; {\cdots} &amp; {\lambda_{N}}\end{array}\right]
$$</div>
<p>定義より、<span class="math">\(G_{i j} =\vec{V}_{i} \cdot \vec{V}_{j}\)</span> という関係があるので、</p>
<div class="math">$$\left(\overrightarrow{V_{1}} \overrightarrow{V_{2}} \ldots \overrightarrow{V_{N}}\right)^{t}\left(\overrightarrow{V_{1}} \overrightarrow{V_{2}} \ldots \overrightarrow{V_{N}}\right)=G=P A P^{t}=\left(A^{1 / 2} P^{t}\right)^{t}\left(A^{1 / 2} P^{t}\right)$$</div>
<p>より、<span class="math">\(V_{i,j} = \lambda_j^{1/2}E_{j,i}\)</span> と距離 <span class="math">\(D_{ij}\)</span> からグラム行列 <span class="math">\(G\)</span> を使って位置 <span class="math">\(\vec{V}_{i}\)</span> を推定できることがわかる。</p>
<h2>問題4 ヒトゲノムの配列構造</h2>
<p>※この問題の解答は、<a href="https://github.com/Naoto-Yamaguchi">Naoto-Yamaguchi</a>に作成してもらいました。</p>
<h3>1</h3>
<ul>
<li>物理的距離：遺伝子間の距離を塩基数で示したもの。ヒトゲノム解析で可能となった挿入・削除等により、個人差がある。</li>
<li>遺伝的距離：組み換え頻度から推定した遺伝子座の距離。１回の減数分裂で交叉が起きる回数の期待値が <span class="math">\(k\)</span> となる２つの遺伝子座間の距離を <span class="math">\(k\ \mathrm{Morgan}\)</span> と呼び、<span class="math">\(1\ \mathrm{cm} = 0.01\ \mathrm{Morgan}\)</span> を単位として用いる。</li>
</ul>
<h4>両者の関係</h4>
<p>両者の距離は、多型マーカーの代表例であるSNP間の距離を測るのに用い、ゲノム解読以前は、遺伝的距離、以降は物理的距離が主に用いられた。
しかし、<font color="red"><b>交叉のHotspot（相同組換えの頻発部位）</b></font>が存在することで、交叉の回数の期待値が場所に依存するため、両者は<font color="red"><b>必ずしも比例しない</b></font></p>
<h3>2</h3>
<ul>
<li>アレル：相同の遺伝子座にあって、異なる遺伝情報を有する遺伝子のこと。対立遺伝子</li>
<li>遺伝子型：２つの対立遺伝子の組であり、同じアレルの組の時ホモ接合、異なるアレルの組の時ヘテロ接合と呼ぶ。</li>
</ul>
<h4>両者の関係</h4>
<ul>
<li>アレルが優性遺伝形式に従う場合、そのアレルのホモ・ヘテロ接合で表現型として現れる。</li>
<li>アレルが劣性遺伝形式に従う場合、そのアレルのホモ接合のみで表現型として現れる。</li>
<li>集団がハーディ・ワインバーグ平衡に従う場合、アレル頻度が <span class="math">\(A:a=p:q\)</span> だとすると、<span class="math">\(AA:Aa:aa = p^2:2pq:q^2\)</span> となる。</li>
</ul>
<h3>3</h3>
<p>多型マーカーがHWEに従うことが重要なのは、以下のような平衡状態にない遺伝子型を排除することで、マーカーとして正しく機能することを保証できるからである。</p>
<ul>
<li>近親婚などホモ接合が増える場合</li>
<li>遺伝子型の観測方法が不正確な場合</li>
</ul>
<h4>検定方法</h4>
<div class="math">$$p(n_{AB}) = \left(\frac{n! \cdot2^{n_{AB}}}{n_{AA}!n_{AB}!n_{BB}!}\right)/\left(\frac{(2n)!}{n_A!n_a!}\right)$$</div>
<p>ここで、遺伝子型ABを <span class="math">\(X\)</span> 人のゲノムで観測した時、<span class="math">\(X\)</span> 個以下となる確率の総和 <span class="math">\(\sum\left\{p(n_{AB})|n_{AB}\leq X\right\}\)</span> が有意水準以下ならば、帰無仮説を棄却し、HWEにないとする。</p>
<h3>4</h3>
<h4>ハプロタイプ</h4>
<p>２倍体において片側の染色体上の遺伝子（or SNP）の列のこと。</p>
<h4>連鎖不平衡</h4>
<p>組換えがランダムな位置で多数起こった結果、ハプロタイプ上のアレルが、頻度率に従って並んだ状態のこと。</p>
<p>しかし、実際には近い遺伝子間など内部で組換えが起こりにくいハプロタイプである「連鎖不平衡ブロック」や交叉の起こりやすい「交叉のhot spot」が存在し、連鎖平衡でない連鎖不平衡の状態にあることが多い。</p>
<p>この不平衡状態を定量的に表す指標として、高頻度のアレルの連鎖不平衡係数 <span class="math">\(D_{AB}\)</span> と、それを <span class="math">\(-1\sim+1\)</span> に正規化した <span class="math">\(D_{AB}'\)</span> を用いる。
この <span class="math">\(D_{AB}'=1\)</span> とは、組換えを起こしておらず、完全に連鎖不平衡であることを示す。</p>
<p>また、各遺伝子間の <span class="math">\(D'\)</span> を解析することで、連鎖不平衡ブロック、組換えのhot spotがわかった他、「組換え位置の特徴」として、組換えのhot spotのモチーフ配列や「結合タンパク質のPRDH9」が発見された。</p>
<p>連鎖不平衡ブロックの代表点を安価に調査し、多様な疾患の罹患リスク予測やハプロタイプ別祖先推定を行うサービスが23andMeから発表され話題を呼んだ。</p>
<h2>問題5 Genome Wide Association Study(GWAS)</h2>
<div style="border: solid 1.0px #000000;padding: 0.5em 1em; margin: 2em 0;">
  <h3>多重検定問題</h3>
  マーカー数が多くなると、<b>「遺伝子型が対象疾患に関連しない」</b>という帰無仮説を誤って棄却して、疾患と関連があるとみなす偽陽性のマーカーが増える。なお、p値は、<font color="red"><b>「帰無仮説の下で実験データが得られる確率」</b></font>である。
</div>

<p>多重性は、<b>「数撃てば当た」</b>ってしまうことが問題である。例えば、サイコロを一回投げた場合、<span class="math">\(1\)</span> の目が出る確率は <span class="math">\(1/6\)</span> である。しかし、サイコロを <span class="math">\(n\)</span> 回数投げた場合、少なくとも <span class="math">\(1\)</span> 回 <span class="math">\(1\)</span> の目が出る確率は <span class="math">\(1-\left(1-\left(\frac{1}{6}\right)\right)^n\)</span> である。これは、次第に大きくなってしまう。</p>
<h3>1</h3>
<p>例えば <span class="math">\(n=5\times10^5\)</span> 個の<b>各マーカー</b>を有意水準 <span class="math">\(\alpha=0.05\)</span> で検定すると、有意になるマーカー数の期待値は <span class="math">\(2.5\times10^4\)</span> 個となり、非常に多くなってしまう。</p>
<h3>2</h3>
<p>Bonferroniの補正は、<b>「<span class="math">\(n\)</span> 個のすべての位置の遺伝子型が対象疾患に相関しない」を有意水準 <span class="math">\(\alpha\)</span> で検定する</b>作業を<b>「各位置において遺伝子型が対象疾患に関連しない」を<font color="red">有意水準 <span class="math">\(\alpha/n\)</span> で検定する操作を繰り返すことで近似する</b></font></p>
<p>この時、</p>
<ul>
<li><b>「全マーカーで帰無仮説『各位置において遺伝子型が対象疾患に関連しない』</b>が棄却されない確率 <span class="math">\((1-\alpha/n)^n\)</span> 」</li>
<li><b><span class="math">\(1-\)</span>「帰無仮説『<span class="math">\(n\)</span> 個のすべての位置の遺伝子型が対象疾患に相関しない』が棄却される確率」<span class="math">\(=\alpha\)</span></b></li>
</ul>
<p>の２つが等しくなれば上手く近似されたことになるが、<span class="math">\(\alpha/n\approx0\)</span> を仮定して<b>テイラー展開</b>を用いることで以下が成り立つので、ある程度の正当性は見込まれる。</p>
<div class="math">$$1-\left(1-\alpha/n\right)^n\approx1-\left(1-n(\alpha/n\right)) = \alpha$$</div>
<p>ただし、(1)の例であれば有意水準が <span class="math">\(\alpha/n = 1\times10^{-7}\)</span> となり、少し厳しすぎてしまう。</p>
<h3>3</h3>
<p>FDR(False discovery rate)は、<font color="red"><b>真の帰無仮説を誤って棄却した割合の期待値</b></font>を表している。</p>
<p>ここで、有意水準 <span class="math">\(\alpha\)</span> で棄却されるマーカーの中で、疾患に関連しないが誤って棄却されるマーカーの数の期待値は <span class="math">\(n\alpha\)</span> で表される。</p>
<p>よって、以下の手順で設定したFDRを満たす有意水準を見つけることができる。</p>
<ol>
<li><span class="math">\(\mathrm{FDR}\)</span> を決める。</li>
<li><span class="math">\(n\)</span> 個のマーカーそれぞれに対して検定を行い、p値を計算する。</li>
<li><span class="math">\(n\)</span> 個の <span class="math">\(p\)</span> 値を昇順に並べる。（<span class="math">\(p_1\leq p_2\leq\ldots\leq p_n\)</span>）</li>
<li><span class="math">\(i=m\)</span> とおく。</li>
<li><span class="math">\(np_i\leq i\mathrm{FDR}\)</span> を満たす場合、<span class="math">\(k=i\)</span> として6に進む。そうでなければ <span class="math">\(i\leftarrow i-1\)</span> として再びこの操作を繰り返す。なお、<span class="math">\(i=1\)</span> に達した場合、どの仮説も棄却することなく終了する。</li>
<li>仮説 <span class="math">\(i=1,2,\ldots,k\)</span> に対応するマーカーを全て棄却する。</li>
</ol>
<p><font color="red"><b>※ ただし、一般に <span class="math">\(i \rightarrow i-1\)</span> とした際に <span class="math">\(np_i/i\)</span> が小さくなるとは限らない（例：<span class="math">\(p_i=p_{i-1}\)</span>）ため、この方法にも限界がある。</b></font></p>
<h4>補足</h4>
<p>以下の式の意味を考える。</p>
<div class="math">$$np_i\leq i\mathrm{FDR}$$</div>
<ul>
<li><span class="math">\(np_i\)</span> は、有意水準 <span class="math">\(p_i\)</span> で棄却したマーカーの中で、疾患に関連しないが誤って棄却されるマーカーの数の期待値</li>
<li><span class="math">\(\mathrm{FDR}\)</span> は、棄却されたマーカーの中で、疾患に関連しないが誤って棄却されるマーカーの数の期待値</li>
</ul>
<p>したがって、上の不等式を満たす場合、関連しないマーカーを棄却してしまう確率を予め設定したFDRによって上から抑えることが出来る。</p>
<h2>問題6 連鎖解析</h2>
<p>※この問題の解答は、<a href="https://github.com/Naoto-Yamaguchi">Naoto-Yamaguchi</a>に作成してもらいました。</p>
<h3>1</h3>
<p>IBD vectorとは、ある家系の「３世代」の継承関係を元に孫の順序付遺伝子型を数値に変換してベクトル表現したもの。</p>
<p>子の各「アレル」が祖父由来なら <span class="math">\(0\)</span>、祖母由来なら <span class="math">\(1\)</span> と定義することで、4次元ベクトルで <span class="math">\(2^4=16\)</span> 通りの継承関係を表現できる。</p>
<p>ここで、「罹患同胞対(りかんどうほうつい, affected sib-pair, 同じ疾患に罹患した兄弟で観察された共有する同祖遺伝子,IBD)」を分析することで、「劣性遺伝形式」ならIBD=2,「優性遺伝形式」ならIBD=1,2を説明できる。</p>
<h3>2</h3>
<table>
<thead>
<tr>
<th align="center">変数</th>
<th align="left">意味</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><span class="math">\(i\)</span></td>
<td align="left">DNA上の位置</td>
</tr>
<tr>
<td align="center"><span class="math">\(X_i\)</span></td>
<td align="left">位置 <span class="math">\(i\)</span> の子の順序<font color="red"><b>無</b></font>遺伝子型</td>
</tr>
<tr>
<td align="center"><span class="math">\(I_i\)</span></td>
<td align="left">位置 <span class="math">\(i\)</span> のIBD vector<br><font color="red"><b>観測困難なので、予測する</b></font></td>
</tr>
<tr>
<td align="center"><span class="math">\(P(X_i,I_i)\)</span></td>
<td align="left">位置 <span class="math">\(i\)</span> で <span class="math">\(X_i\)</span> と <span class="math">\(I_i\)</span> が起こる確率</td>
</tr>
<tr>
<td align="center"><span class="math">\(P(Z)\)</span></td>
<td align="left">アレル <span class="math">\(Z\)</span> の出現確率</td>
</tr>
</tbody>
</table>
<h4><span class="math">\(X_i = \mathrm{AABC},\ \text{IBD vector} = 1100\)</span></h4>
<ul>
<li>子の順序付き遺伝子型は <span class="math">\(\mathrm{AABC},\mathrm{AACB}\)</span></li>
<li>親の順序付き遺伝子型は <span class="math">\(\mathrm{BACA},\mathrm{CABA}\)</span></li>
<li>求める確率 <span class="math">\(P(X_i,I_i) = 1/16 p_{\mathrm{A}}^2p_Bp_C\times2\)</span></li>
</ul>
<h4><span class="math">\(X_i = \mathrm{ABAC},\ \text{IBD vector} = 0010\)</span></h4>
<ul>
<li>子の順序付き遺伝子型は <span class="math">\(\mathrm{ABAC},\mathrm{ABCA},\mathrm{BAAC},\mathrm{BACA}\)</span></li>
<li>親の順序付き遺伝子型は、子の順序付き遺伝子が <span class="math">\(\mathrm{BACA}\)</span> の時のみ矛盾なく決めることができ、<span class="math">\(\mathrm{BCA?}\)</span></li>
<li>求める確率 <span class="math">\(P(X_i,I_i) = 1/16 p_{\mathrm{A}}p_Bp_C\)</span></li>
</ul>
<p>（以下省略）</p>
<h3>3</h3>
<table>
<thead>
<tr>
<th align="center">変数</th>
<th align="left">意味</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><span class="math">\(P(I_i)\)</span></td>
<td align="left">位置 <span class="math">\(i\)</span> で <span class="math">\(I_i\)</span> となる確率</td>
</tr>
<tr>
<td align="center"><span class="math">\(P(X_i\mid I_{i-1})\)</span></td>
<td align="left">IBD vector が <span class="math">\(I_i\)</span> の時 <span class="math">\(X_i\)</span> を観測する条件付確率</td>
</tr>
<tr>
<td align="center"><span class="math">\(P(I_i\mid I_{i-1})\)</span></td>
<td align="left"><span class="math">\(I_{i-1}\)</span> から <span class="math">\(I_i\)</span> へ遷移する確率</td>
</tr>
</tbody>
</table>
<p>Hidden Markov Model を用いて、最もらしい（<span class="math">\(P(X_1\cdots X_M|I_i)\)</span> を最大化する）IBD vector <span class="math">\(I_i\)</span> の列を推定する。
→推定したIBD vectorから組み換え位置を予測できる!!</p>
<p>ここで、<span class="math">\(P(X_1|I_1) = 1,P(X_M|I_M) = 1\)</span> と初期化して、以下の漸化式を回すことで、以下を最大化するIBD vector <span class="math">\(I_i\)</span> の列を推定できる。</p>
<div class="math">$$P(X_1\cdots X_M|I_i) = P(X_1\cdots X_{j-1}|I_j)P(X_j|I_j)P(X_{j+1}\ldots X_M|I_j)$$</div>
<h4>漸化式</h4>
<div class="math">$$
\begin{aligned}
P(I_j|I_{j-1})
&amp;= \theta^k\left(1-\theta\right)^{4-k}\\
P(X_1,\cdots X_{j-1}|I_j)
&amp;= \sum_{\text{IBD vector }I_{j-1}} P(X_1,\cdots X_{j-2}|I_{j-1})P(X_{j-1}|I_{j-1})P(I_j|I_{j-1})\\
P(X_{j+1},\cdots,X_M|I_j)
&amp;=\sum_{\text{IBD vector }I_{j+1}} P(X_{j+2},\cdots X_M|I_{j+1})P(X_{j+1}|I_{j+1})P(I_{j+1}|I_{j})
\end{aligned}
$$</div>
<p>※ 2つのIBD vector <span class="math">\(I_j\)</span> と <span class="math">\(I_{j-1}\)</span> の間で一致しない要素の数を <span class="math">\(k\)</span> と定義している。</p>
<h3>4</h3>
<p>常染色体劣性形式の場合、IBD=2の場合でしか劣性遺伝（疾患の原因変異が劣性）を説明できないが、これは全16パターンあるIBD vectorのうち4パターンのみである。したがって、<span class="math">\(4/16=1/4\)</span> の領域まで責任遺伝子領域を絞ることが出来るから。</p>
<h2>問題7 AdaBoost</h2>
<div style="border: solid 1.0px #000000;padding: 0.5em 1em; margin: 2em 0;">
  <h3>AdaBoostの基本的考え方</h3>
  <li>各レコード（データ）の予測の困難さを重みで表現<br>初期状態は重み均衡（どのデータが難しいかわからないので）</li>
  <li>次のステップを繰返す</li>
  <ol>
    <li>ランダムに推測するよりは正答率の高い弱学習器を生成。</li>
    <li>目標属性の値を正しく予測できたら重みを下げる。</li>
    <li>誤って予測したら重みはそのまま（重みは相対的に上昇）</li>
  </ol>
  <li>弱学習器の重み付き多数決で最終的な予測を行う。</li>
</div>

<h4><span class="math">\(\sum_{i=1}^{N} w_{i}^{t+1} \leq\left(\sum_{i=1}^{N} w_{i}^{t}\right) \times 2 \varepsilon_{t}\)</span> の証明</h4>
<div class="math">$$
\begin{aligned}
\sum_{i=1}^{N} w_{i}^{t+1}
&amp;= \sum_{i=1}^{N} w_{i}^{t} \beta_{t}^{1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|} \\
&amp;= \sum_{i=1}^{N} w_{i}^{t}\left(1-\left(1-\beta_{t}\right)\left(1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|\right)\right)\quad(\because \ast1)\\
&amp;=\sum_{i=1}^{N} w_{i}^{t}-\left(1-\beta_{t}\right) \sum_{i=1}^{N} w_{i}^{t}\left(1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|\right)\\
&amp;=\sum_{i=1}^{N} w_{i}^{t}-\left(1-\beta_{t}\right) (1-\varepsilon_t) \sum_{i=1}^{N}w_i^t\quad(\because \ast2)\\
&amp;=\left(\sum_{i=1}^{N} w_{i}^{t}\right)\left(1-\left(1-\beta_{t}\right)\left(1-\varepsilon_{t}\right)\right)\\
&amp;=\left(\sum_{i=1}^{N} w_{i}^{t}\right) \times 2 \varepsilon_{t}\quad(\because \ast3)
\end{aligned}
$$</div>
<ul>
<li><span class="math">\(\ast1\)</span>
<span class="math">\(\alpha&gt;0\)</span> で <span class="math">\(\gamma=0,1\)</span> の時、以下が成り立つことは自明
<div class="math">$$\alpha^{\gamma} = 1-(1-\alpha)\gamma$$</div>
</li>
<li><span class="math">\(\ast2\)</span>
定義より、
<div class="math">$$
\begin{aligned}
1-\varepsilon_{t}
&amp;=\sum_{i=1}^{N} p_{i}^{t}-\sum_{i=1}^{N} p_{i}^{t}\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right| \\
&amp;=\sum_{i=1}^{N} p_{i}^{t}\left(1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|\right) \\
&amp;=\sum_{i=1}^{N} w_{i}^{t}\left(1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|\right) /\left(\sum_{i=1}^{N} w_{i}^{t}\right)
\end{aligned}
$$</div>
</li>
<li><span class="math">\(\ast3\)</span>
定義より、<span class="math">\(\beta_t = \varepsilon_t/(1-\varepsilon_t)\)</span> なので、
<div class="math">$$1-\beta_t = \frac{1-2\varepsilon_t}{1-\varepsilon_t}$$</div>
</li>
</ul>
<h4><span class="math">\(h_{f}\left(\vec{x}_{i}\right) \neq y_{i}\)</span> ならば <span class="math">\(\prod_{t=1}^{T} \beta_{t}^{1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|} \geq\left(\prod_{t=1}^{T} \beta_{t}\right)^{1 / 2}\)</span> の証明</h4>
<p>※ 最終クラス分類器 <span class="math">\(h_f\)</span> の出力は以下である。</p>
<div class="math">$$
h_{f}(\vec{x})=\left\{\begin{array}{ll}{1} &amp; {\text { if } \sum_{t=1}^{T}\left(-\log \beta_{t}\right) h_{t}(\vec{x}) \geq \sum_{t=1}^{T}\left(-\log \beta_{t}\right) \frac{1}{2}}\cdots\left(\ast\right) \\
 {0} &amp; {\text { otherwise }}\end{array}\right.
$$</div>
<ul>
<li><span class="math">\(h_{f}\left(\vec{x}_{i}\right)=1, y_{i}=0\)</span> の時
<span class="math">\(\sum_{t=1}^{T}\left(\log \beta_{t}\right)\)</span> を <span class="math">\(\left(\ast\right)\)</span> の両辺に加算すると、
<div class="math">$$
\sum_{t=1}^{T}\left(\log \beta_{t}\right)\left(1-h_{t}\left(\vec{x}_{i}\right)\right) \geq \sum_{t=1}^{T}\left(\log \beta_{t}\right) \frac{1}{2}
$$</div>
ここで、<span class="math">\(1-h_{t}\left(\vec{x}_{i}\right)=1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|\)</span> が成り立つから、題意を満たす。</li>
<li><span class="math">\(h_{f}\left(\vec{x}_{i}\right)=0, y_{i}=1\)</span> の時
<span class="math">\(\left(\ast\right)\)</span> の <span class="math">\(\text { otherwise }\)</span> であることから、
<div class="math">$$\sum_{t=1}^{T}\left(-\log \beta_{t}\right) h_{t}\left(\vec{x}_{i}\right)&lt;\sum_{t=1}^{T}\left(-\log \beta_{t}\right) \frac{1}{2}$$</div>
ここで、<span class="math">\(h_{t}\left(\vec{x}_{i}\right)=1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|\)</span> が成り立つから、題意を満たす。</li>
</ul>
<h4><span class="math">\(\sum_{i=1}^{N} w_{i}^{T+1} \geq \varepsilon\left(\prod_{t=1}^{T} \beta_{t}\right)^{1 / 2}\)</span> の証明</h4>
<div class="math">$$
\begin{aligned}
\sum_{i=1}^{N} w_{i}^{T+1}
&amp;\geq \sum_{\left\{i | h_{f}\left(\vec{x}_{i}\right) \neq y_{i}\right\}} w_{i}^{T+1}\\
&amp;= \sum_{\left\{i | h_{f}\left(\vec{x}_{i}\right) \neq y_{i}\right\}}\left(w_i^1 \prod_{t=1}^{T} \beta_{t}^{1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|}\right) &amp;\left(\because w_{i}^{t+1}=w_{i}^{t} \beta_{t}^{1-\left|h_{t}\left(\vec{x}_{i}\right)-y_{i}\right|}\right)\\
&amp;\geq \sum_{\left\{i | h_{f}\left(\vec{x}_{i}\right) \neq y_{i}\right\}}\left(\frac{1}{N}\left(\prod_{t=1}^{T} \beta_{t}\right)^{1 / 2}\right)
&amp;\left(\because\text{1つ上で示した不等式}\right)\\
&amp;=\left(\sum_{\left\{i | h_{f}\left(\vec{x}_{i}\right) \neq y_{i}\right\}}\frac{1}{N}\right)\left(\prod_{t=1}^{T} \beta_{t}\right)^{1 / 2}
\end{aligned}
$$</div>
<p>
※ここで、<span class="math">\(\varepsilon=\sum_{\left\{i | h_{f}\left(\vec{x}_{i}\right) \neq y_{i}\right\}} \frac{1}{N}\)</span></p>
<p><font color="red"><b>ここまでに証明した各種不等式を用いてBoosting Propertyを示す!!</b></font></p>
<h4><span class="math">\(\varepsilon \leq \prod_{t=1}^{T} 2 \sqrt{\varepsilon_{t}\left(1-\varepsilon_{t}\right)}=\prod_{t=1}^{T} \sqrt{1-\left(1-2 \varepsilon_{t}\right)^{2}}\)</span> の照明</h4>
<div class="math">$$
\begin{aligned}
\varepsilon\left(\prod_{t=1}^{T} \beta_{t}\right)^{1 / 2}
&amp;\leq \sum_{i=1}^{N} w_{i}^{T+1}\\
&amp;\leq\left(\sum_{i=1}^{N} w_{i}^{T}\right) \times 2 \varepsilon_{t}\\
&amp;\vdots\\
&amp;\leq\left(\sum_{i=1}^Nw_i^1\right)\prod_{t=1}^T2\varepsilon_t\\
&amp;= \prod_{t=1}^T2\varepsilon_t
\end{aligned}
$$</div>
<p>定義より <span class="math">\(\beta_{t}=\varepsilon_{t} /\left(1-\varepsilon_{t}\right)\)</span> だから、</p>
<div class="math">$$\varepsilon \leq \prod_{t=1}^{T}\left(2 \varepsilon_{t} \times \beta_{t}^{-1 / 2}\right)=\prod_{t=1}^{T} 2 \sqrt{\varepsilon_{t}\left(1-\varepsilon_{t}\right)}$$</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        fonts: [['STIX', 'TeX']]," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            <div>
</div>

            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h5>Published</h5>
            <time itemprop="dateCreated" datetime="2019-07-25T00:00:00+09:00"> 7 25, 2019</time>

<h5>Last Updated</h5>
<time datetime="0019-07-25T00:00:00+09:19"> 7 25, 0019</time>

            <h5>Category</h5>
            <a class="category-link" href="https://iwasakishuto.github.io/study/notes/categories.html#sheng-wu-qing-bao-sohutouealun-ref">生物情報ソフトウエア論</a>
            <h5>Tags</h5>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://iwasakishuto.github.io/study/notes/tags#3s-ref">3S
                    <span>79</span>
</a></li>
                <li><a href="https://iwasakishuto.github.io/study/notes/tags#sheng-wu-qing-bao-sohutouealun-ref">生物情報ソフトウエア論
                    <span>2</span>
</a></li>
            </ul>
<h5>Contact</h5>
    <a href="https://twitter.com/cabernet_rock" title="My twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-twitter sidebar-social-links"></i></a>
    <a href="https://github.com/iwasakishuto" title="My github Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-github sidebar-social-links"></i></a>
    <a href="https://www.facebook.com/iwasakishuto" title="My facebook Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-facebook sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="https://github.com/Pelican-Elegant/elegant/" title="Theme Elegant Home Page">Elegant</a></li>
    </ul>
</div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>
        <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>

    
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/study/notes/theme/css/jupyter.css" media="screen">
    </body>
    <!-- Theme: Elegant built for Pelican
    License : MIT -->
</html>